syntax = "proto3";

option java_multiple_files = true;
option java_package = "it.unibo.tuprolog.solve.lpaas";
option java_outer_classname = "LPaaS";

package lpaas;
import "solverElements.proto";
import "solverFactory.proto";

/* Solver Service & Messages*/

service Solver {
  rpc Solve(SolveRequest) returns (SolutionSequence) {}
  rpc GetSolution(SolutionID) returns (SolutionReply) {}
  /*rpc WriteOnInputChannel(stream WrittenLine) {}
  rpc ReadFromOutputChannel(SolverID) returns (stream ReadLine) {}
  rpc GetFlags(SolverID) returns (Flags) {}
  rpc GetStaticKB(SolverID) returns (stream Clause) {}
  rpc GetDynamicKB(SolverID) returns (stream Clause) {}
  rpc GetLibraries(SolverID) returns (Runtime) {}
  rpc GetUnificator(SolverID) returns (Unificator) {}
  rpc GetOperators(SolverID) returns (OperatorSet) {}
  rpc GetInputChannels(SolverID) returns (ChannelID) {}
  rpc GetOutputChannels(SolverID) returns (ChannelID) {}*/
}

/* Request messages */

message SolveRequest {
  message Options {
    string name = 1;
    optional int64 value = 2;
  }

  optional string solverID = 1;
  string struct = 2;
  repeated Options options = 3;
}

message SolutionID {
  string solverID = 1;
  string computationID = 2;
  string query = 3;
  int32 index = 4;
}

/* Reply messages */

message SolutionSequence {
  string solverID = 1;
  string computationID = 2;
  string query = 3;
}

message SolutionReply {
  bool isYes = 4;
  bool isNo = 5;
  bool isHalt = 6;
  string query = 1;
  repeated Substitution substitution = 3;
  optional string error = 7;
}


// Liste bloccanti per quando si fanno input-output channel
// Stampe canale output, fa da quel momento in poi o anche prima?

//serializza execution context, opzionale custom data store (conversione in stringa di Any)


